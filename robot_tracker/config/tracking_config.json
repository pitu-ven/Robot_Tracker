{
  "_metadata": {
    "version": "2.0",
    "description": "Configuration tracking avec TargetTab simplifi√© (sans gestion cam√©ra redondante)",
    "last_modified": "2025-01-15T15:30:00Z",
    "compatibility": "Robot Trajectory Controller v1.6+"
  },

  "target_detection": {
    "aruco": {
      "enabled": true,
      "auto_detect_folder": true,
      "default_markers_folder": "./aruco_markers",
      "config_file_name": "markers_config.json",
      "supported_extensions": [".png", ".jpg", ".jpeg"],
      "detection_params": {
        "adaptiveThreshWinSizeMin": 3,
        "adaptiveThreshWinSizeMax": 23,
        "maxMarkerPerimeterRate": 4.0,
        "minMarkerPerimeterRate": 0.1,
        "polygonalApproxAccuracyRate": 0.03,
        "minMarkerDistanceRate": 0.1,
        "cornerRefinementWinSize": 5,
        "cornerRefinementMaxIterations": 30,
        "cornerRefinementMinAccuracy": 0.1
      },
      "marker_size_mm": 100,
      "camera_matrix": null,
      "distortion_coeffs": null
    },

    "reflective_markers": {
      "enabled": true,
      "detection_method": "hsv_threshold",
      "hsv_ranges": {
        "lower": [0, 0, 200],
        "upper": [180, 30, 255]
      },
      "morphology": {
        "enabled": true,
        "kernel_size": 5,
        "iterations": 2,
        "operation": "opening"
      },
      "contour_filters": {
        "min_area": 50,
        "max_area": 5000,
        "min_circularity": 0.7,
        "min_convexity": 0.8,
        "min_inertia": 0.01
      },
      "blob_detector": {
        "enabled": false,
        "min_threshold": 50,
        "max_threshold": 220,
        "threshold_step": 10,
        "min_repeatability": 2
      }
    },

    "led_markers": {
      "enabled": false,
      "color_presets": {
        "red": {
          "h_range": [0, 10],
          "s_range": [50, 255], 
          "v_range": [50, 255],
          "secondary_h": [170, 180]
        },
        "green": {
          "h_range": [40, 80],
          "s_range": [50, 255],
          "v_range": [50, 255]
        },
        "blue": {
          "h_range": [100, 130],
          "s_range": [50, 255],
          "v_range": [50, 255]
        }
      },
      "preprocessing": {
        "gaussian_blur_kernel": 5,
        "brightness_boost": 1.2,
        "contrast_boost": 1.1
      },
      "tracking": {
        "smoothing_factor": 0.8,
        "max_disappeared_frames": 30,
        "min_detection_confidence": 0.6
      }
    }
  },

  "target_tab_ui": {
    "window": {
      "title": "Onglet Cible - D√©tection et Suivi",
      "update_interval_ms": 33,
      "ui_refresh_rate": 30,
      "control_panel_width": 320,
      "video_display_min_height": 480
    },

    "roi": {
      "enabled": true,
      "max_roi_count": 5,
      "selection_tools": ["rectangle", "polygon"],
      "default_tool": "rectangle",
      "line_thickness": 2,
      "selection_handles_size": 8,
      "snap_distance": 10,
      "colors": {
        "active_roi": [255, 255, 0],
        "inactive_roi": [128, 128, 128],
        "creating_roi": [0, 255, 255],
        "selected_roi": [255, 0, 255]
      }
    },

    "display": {
      "overlays": {
        "show_aruco_ids": true,
        "show_aruco_axes": false,
        "show_detection_boxes": true,
        "show_confidence_scores": true,
        "show_roi_boundaries": true,
        "show_tracking_trail": true,
        "trail_length": 50
      },
      "colors": {
        "aruco_detection": [0, 255, 0],
        "reflective_detection": [255, 0, 0], 
        "led_detection": [0, 0, 255],
        "tracking_trail": [255, 165, 0],
        "text_overlay": [255, 255, 255],
        "background_overlay": [0, 0, 0]
      },
      "fonts": {
        "marker_id": {"size": 14, "bold": true, "thickness": 2},
        "confidence": {"size": 10, "bold": false, "thickness": 1},
        "statistics": {"size": 12, "bold": false, "thickness": 1},
        "roi_label": {"size": 11, "bold": true, "thickness": 2}
      },
      "zoom": {
        "min_zoom": 25,
        "max_zoom": 400,
        "default_zoom": 100,
        "zoom_step": 25
      }
    },

    "tracking": {
      "fps_target": 30,
      "confidence_threshold": 80,
      "detection_types_default": {
        "aruco": true,
        "reflective": true,
        "led": false
      },
      "auto_start_on_camera": false,
      "save_intermediate_frames": false
    },

    "export": {
      "formats": ["csv", "json", "xlsx"],
      "default_format": "csv",
      "auto_export_on_stop": false,
      "include_timestamps": true,
      "include_confidence_scores": true,
      "include_roi_info": true,
      "fields": {
        "basic": ["timestamp", "target_id", "x", "y", "confidence"],
        "extended": ["timestamp", "target_id", "target_type", "x", "y", "z", "confidence", "roi_id", "detection_method"],
        "full": ["timestamp", "target_id", "target_type", "x", "y", "z", "rotation", "confidence", "roi_id", "detection_method", "frame_number", "processing_time"]
      },
      "default_field_set": "extended"
    },

    "ui_labels": {
      "groups": {
        "camera_status": "üì∑ √âtat Cam√©ra",
        "aruco_config": "üéØ Configuration ArUco", 
        "detection_types": "üîç Types de D√©tection",
        "roi_tools": "üìê Outils ROI",
        "tracking_controls": "üé¨ Contr√¥les Tracking",
        "statistics": "üìä Statistiques"
      },
      "buttons": {
        "select_aruco_folder": "üìÅ S√©lectionner Dossier",
        "rescan_folder": "üîÑ",
        "advanced_config": "‚öôÔ∏è Configuration Avanc√©e",
        "roi_rectangle": "‚¨ú Rectangle",
        "roi_polygon": "‚¨ü Polygone", 
        "clear_roi": "üóëÔ∏è Effacer",
        "start_tracking": "‚ñ∂Ô∏è D√©marrer",
        "stop_tracking": "‚èπÔ∏è Arr√™ter",
        "export_data": "üíæ Exporter Donn√©es"
      },
      "tooltips": {
        "camera_status": "√âtat de connexion avec l'onglet Cam√©ra",
        "aruco_folder": "Dossier contenant les marqueurs ArUco g√©n√©r√©s",
        "rescan": "Rescanner le dossier ArUco s√©lectionn√©",
        "detection_aruco": "Activer/d√©sactiver la d√©tection des marqueurs ArUco",
        "detection_reflective": "Activer/d√©sactiver la d√©tection des marqueurs r√©fl√©chissants", 
        "detection_led": "Activer/d√©sactiver la d√©tection des LEDs color√©es",
        "roi_rectangle": "Cr√©er une r√©gion d'int√©r√™t rectangulaire",
        "roi_polygon": "Cr√©er une r√©gion d'int√©r√™t polygonale",
        "fps_target": "Fr√©quence de traitement cible (fps)",
        "confidence": "Seuil de confiance minimum pour les d√©tections (%)",
        "zoom_slider": "Niveau de zoom de l'affichage vid√©o"
      },
      "status_messages": {
        "no_camera": "‚ùå Aucune cam√©ra active",
        "camera_ready": "‚úÖ Cam√©ra: {alias}",
        "waiting_stream": "En attente du flux cam√©ra...",
        "tracking_active": "üé¨ Tracking actif - {fps:.1f} fps",
        "tracking_inactive": "‚èπÔ∏è Tracking arr√™t√©",
        "no_aruco_folder": "Aucun dossier ArUco s√©lectionn√©",
        "aruco_loaded": "‚úÖ {count} marqueurs ArUco d√©tect√©s",
        "roi_creating": "üìê Cr√©ation ROI en cours...",
        "export_success": "üíæ Donn√©es export√©es vers: {path}",
        "export_error": "‚ùå Erreur export: {error}"
      }
    }
  },

  "kalman_filter": {
    "enabled": true,
    "process_noise": 0.01,
    "measurement_noise": 0.1,
    "prediction_enabled": true,
    "max_prediction_frames": 10,
    "initialization": {
      "min_detections": 3,
      "max_init_frames": 30
    },
    "tracking": {
      "max_disappeared_frames": 15,
      "distance_threshold": 50.0,
      "velocity_smoothing": 0.7
    }
  },

  "performance": {
    "max_tracking_history": 1000,
    "stats_update_interval": 1000,
    "frame_skip_on_overload": true,
    "max_processing_time_ms": 25,
    "threading": {
      "detection_thread": true,
      "display_thread": false,
      "max_queue_size": 5
    },
    "memory": {
      "max_cached_frames": 10,
      "cleanup_interval": 30000,
      "force_gc_threshold": 100
    }
  },

  "debugging": {
    "enabled": false,
    "save_debug_images": false,
    "debug_output_folder": "./debug_tracking",
    "log_detection_times": false,
    "verbose_roi_info": false,
    "show_fps_overlay": true,
    "profiling": {
      "enabled": false,
      "profile_detection": false,
      "profile_display": false
    }
  },

  "integration": {
    "camera_manager": {
      "frame_request_timeout_ms": 100,
      "retry_on_failure": true,
      "max_retries": 3,
      "fallback_behavior": "use_last_frame"
    },
    "signals": {
      "emit_target_detected": true,
      "emit_tracking_status": true,
      "emit_performance_stats": false,
      "status_update_interval": 500
    },
    "compatibility": {
      "camera_tab_version": "4.9+",
      "main_window_version": "1.6+",
      "config_manager_version": "1.0+"
    }
  }
}