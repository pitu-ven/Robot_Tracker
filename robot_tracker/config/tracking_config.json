{
  "_metadata": {
    "version": "2.2",
    "description": "Configuration tracking avec corrections mineures et ajouts manquants",
    "last_modified": "2025-01-15T18:00:00Z",
    "compatibility": "Robot Trajectory Controller v1.6+"
  },

  "target_detection": {
    "aruco": {
      "enabled": true,
      "auto_detect_folder": true,
      "default_markers_folder": "./ArUco",
      "fallback_folders": [
        "C:/0_COMPOSITADOUR/6_JERICO/Robot_Tracker/ArUco",
        "./aruco_markers",
        "../ArUco",
        "./markers"
      ],
      "config_file_name": "markers_config.json",
      "supported_extensions": [".png", ".jpg", ".jpeg", ".bmp"],
      "detection_params": {
        "adaptiveThreshWinSizeMin": 3,
        "adaptiveThreshWinSizeMax": 23,
        "maxMarkerPerimeterRate": 4.0,
        "minMarkerPerimeterRate": 0.03,
        "polygonalApproxAccuracyRate": 0.03,
        "minMarkerDistanceRate": 0.1,
        "cornerRefinementWinSize": 5,
        "cornerRefinementMaxIterations": 30,
        "cornerRefinementMinAccuracy": 0.1,
        "minCornerDistanceRate": 0.05,
        "minDistanceToBorder": 3,
        "minMarkerDistance": 10.0,
        "cornerRefinementMethod": 0,
        "errorCorrectionRate": 0.6,
        "aprilTagQuadDecimate": 1.0,
        "aprilTagQuadSigma": 0.0,
        "aprilTagMinClusterPixels": 5,
        "aprilTagMaxNmaxima": 10,
        "aprilTagCriticalRad": 0.1745329252,
        "aprilTagMaxLineFitMse": 10.0,
        "aprilTagMinWhiteBlackDiff": 5,
        "aprilTagDeglitch": 0,
        "detectInvertedMarker": false,
        "useAruco3Detection": false,
        "minSideLengthCanonicalImg": 32,
        "minMarkerLengthRatioOriginalImg": 0.0
      },
      "marker_size_mm": 100,
      "camera_matrix": null,
      "distortion_coeffs": null,
      "dictionary_type": "5X5_100"
    },

    "reflective_markers": {
      "enabled": false,
      "detection_method": "hsv_threshold",
      "hsv_ranges": {
        "lower": [0, 0, 200],
        "upper": [180, 30, 255]
      },
      "morphology": {
        "enabled": true,
        "kernel_size": 5,
        "iterations": 2,
        "operation": "opening"
      },
      "contour_filters": {
        "min_area": 50,
        "max_area": 5000,
        "min_circularity": 0.7,
        "min_convexity": 0.8,
        "min_inertia": 0.01
      },
      "blob_detector": {
        "enabled": false,
        "min_threshold": 50,
        "max_threshold": 220,
        "threshold_step": 10,
        "min_repeatability": 2
      }
    },

    "led_markers": {
      "enabled": false,
      "color_presets": {
        "red": {
          "h_range": [0, 10],
          "s_range": [50, 255], 
          "v_range": [50, 255],
          "secondary_h": [170, 180]
        },
        "green": {
          "h_range": [40, 80],
          "s_range": [50, 255],
          "v_range": [50, 255]
        },
        "blue": {
          "h_range": [100, 130],
          "s_range": [50, 255],
          "v_range": [50, 255]
        }
      },
      "preprocessing": {
        "gaussian_blur": {
          "enabled": true,
          "kernel_size": 5,
          "sigma": 1.5
        },
        "morphology": {
          "enabled": true,
          "operation": "opening",
          "kernel_size": 3,
          "iterations": 1
        }
      },
      "detection_params": {
        "min_area": 20,
        "max_area": 2000,
        "morphology_kernel": 3,
        "contour_approximation": "simple"
      }
    },

    "roi_management": {
      "selection_tools": ["rectangle", "polygon", "circle"],
      "default_tool": "rectangle",
      "line_thickness": 2,
      "colors": {
        "active_roi": [255, 255, 0],
        "inactive_roi": [128, 128, 128],
        "creation_roi": [0, 255, 255],
        "selected_roi": [255, 0, 255]
      },
      "interaction": {
        "enable_resize_handles": true,
        "handle_size": 8,
        "snap_to_grid": false,
        "grid_size": 10
      },
      "auto_save": {
        "enabled": true,
        "file_path": "./config/last_session_rois.json",
        "save_interval_seconds": 30
      }
    },

    "fps_target": 30,
    "confidence_threshold": 0.6,
    "max_tracking_history": 1000,
    "detection_timeout_ms": 100,
    "multi_threading": {
      "enabled": true,
      "max_worker_threads": 2,
      "queue_size": 5
    }
  },

  "target_tab_ui": {
    "layout": {
      "control_panel_width": 320,
      "video_display_min_height": 480,
      "controls_bar_height": 60,
      "status_bar_height": 25,
      "splitter_sizes": [320, 800]
    },
    "colors": {
      "aruco_detection": [0, 255, 0],
      "reflective_detection": [255, 0, 0],
      "led_detection": [0, 0, 255],
      "roi_active": [255, 255, 0],
      "roi_inactive": [128, 128, 128],
      "trajectory_line": [255, 165, 0],
      "background": [26, 26, 26],
      "text": [255, 255, 255]
    },
    "fonts": {
      "marker_id": {"family": "Arial", "size": 12, "bold": true},
      "statistics": {"family": "Courier", "size": 10, "bold": false},
      "status": {"family": "Arial", "size": 9, "bold": false},
      "roi_label": {"family": "Arial", "size": 11, "bold": true}
    },
    "display": {
      "show_marker_ids": true,
      "show_confidence": true,
      "show_corners": true,
      "show_center_cross": true,
      "show_roi_labels": true,
      "show_statistics_overlay": false,
      "overlay_transparency": 0.7,
      "line_thickness": 2
    },
    "update_intervals": {
      "video_display_ms": 33,
      "statistics_update_ms": 1000,
      "camera_check_ms": 1000,
      "auto_save_ms": 30000
    },
    "controls": {
      "enable_keyboard_shortcuts": true,
      "shortcuts": {
        "start_tracking": "Space",
        "stop_tracking": "Escape",
        "toggle_roi_creation": "R",
        "clear_all_rois": "Ctrl+Del",
        "export_session": "Ctrl+E"
      }
    }
  },

  "tracking_pipeline": {
    "performance": {
      "max_fps": 30,
      "frame_buffer_size": 10,
      "detection_timeout_ms": 100,
      "max_detection_time_ms": 50
    },
    "kalman_filter": {
      "enabled": true,
      "process_noise": 0.01,
      "measurement_noise": 0.1,
      "initial_error": 1.0,
      "prediction_steps": 3,
      "prediction_weight": 0.8,
      "update_threshold": 5.0,
      "max_prediction_frames": 10
    },
    "data_management": {
      "max_history_points": 10000,
      "auto_cleanup_interval_s": 60,
      "memory_limit_mb": 100
    }
  },

  "export": {
    "formats": ["csv", "json", "xlsx"],
    "default_format": "csv",
    "auto_export_on_stop": false,
    "include_timestamps": true,
    "include_confidence_scores": true,
    "include_roi_info": true,
    "fields": {
      "basic": ["timestamp", "target_id", "x", "y", "confidence"],
      "extended": ["timestamp", "target_id", "target_type", "x", "y", "z", "confidence", "roi_id", "detection_method"],
      "full": ["timestamp", "target_id", "target_type", "x", "y", "z", "rotation", "confidence", "roi_id", "detection_method", "frame_number", "processing_time"]
    },
    "default_field_set": "extended",
    "csv_options": {
      "delimiter": ",",
      "include_headers": true,
      "timestamp_format": "ISO8601"
    },
    "json_options": {
      "pretty_print": true,
      "include_metadata": true
    }
  },

  "ui_labels": {
    "groups": {
      "camera_status": "üì∑ √âtat Cam√©ra",
      "aruco_config": "üéØ Configuration ArUco", 
      "detection_types": "üîç Types de D√©tection",
      "roi_tools": "üìê Outils ROI",
      "tracking_controls": "üé¨ Contr√¥les Tracking",
      "statistics": "üìä Statistiques"
    },
    "buttons": {
      "select_aruco_folder": "üìÅ S√©lectionner Dossier",
      "rescan_folder": "üîÑ",
      "advanced_config": "‚öôÔ∏è Configuration Avanc√©e",
      "roi_rectangle": "‚¨ú Rectangle",
      "roi_polygon": "‚¨ü Polygone", 
      "clear_roi": "üóëÔ∏è Effacer",
      "start_tracking": "‚ñ∂Ô∏è D√©marrer",
      "stop_tracking": "‚èπÔ∏è Arr√™ter",
      "export_data": "üíæ Exporter Donn√©es"
    },
    "tooltips": {
      "camera_status": "√âtat de connexion avec l'onglet Cam√©ra",
      "aruco_folder": "Dossier contenant les marqueurs ArUco g√©n√©r√©s",
      "rescan": "Rescanner le dossier ArUco s√©lectionn√©",
      "detection_aruco": "Activer/d√©sactiver la d√©tection des marqueurs ArUco",
      "detection_reflective": "Activer/d√©sactiver la d√©tection des marqueurs r√©fl√©chissants", 
      "detection_led": "Activer/d√©sactiver la d√©tection des LEDs color√©es",
      "roi_rectangle": "Cr√©er une r√©gion d'int√©r√™t rectangulaire",
      "roi_polygon": "Cr√©er une r√©gion d'int√©r√™t polygonale",
      "fps_target": "Fr√©quence de traitement cible (fps)",
      "confidence": "Seuil de confiance minimum pour les d√©tections (%)",
      "zoom_slider": "Niveau de zoom de l'affichage vid√©o"
    },
    "status_messages": {
      "ready": "Pr√™t pour d√©tection",
      "tracking_active": "Tracking en cours...",
      "camera_disconnected": "Cam√©ra d√©connect√©e",
      "no_markers_detected": "Aucun marqueur d√©tect√©",
      "aruco_folder_empty": "Dossier ArUco vide ou invalide",
      "detection_error": "Erreur de d√©tection"
    }
  },

  "performance": {
    "max_memory_usage_mb": 500,
    "gc_interval_seconds": 60,
    "profiling": {
      "enabled": false,
      "output_file": "./logs/performance.log"
    },
    "optimization": {
      "skip_frames_if_lagging": true,
      "reduce_quality_under_load": false,
      "adaptive_detection_params": true
    }
  },

  "logging": {
    "level": "INFO",
    "file_path": "./logs/target_detection.log",
    "max_file_size_mb": 50,
    "backup_count": 5,
    "log_detections": true,
    "log_performance": false
  }
}